using NeteaseCloudMusicSDK.ApiClient;

namespace NexteaseCloudMusicSDK.WebApi.Middlewares
{
    public class AuthMiddleware
    {
        private readonly RequestDelegate _next;

        private readonly RequestContext _context;

        public AuthMiddleware(RequestDelegate next, RequestContext context)
        {
            _next = next;
            _context = context;
        }

        //Process the cookie
        public async Task Invoke(HttpContext context)
        {
            //GET the cookie string from front end or other place

            _context.Cookie = "NMTID=00O7qNg3YLIVHdQMkR0vRdbg9spStcAAAGUGnttWQ; _iuqxldmzr_=32; _ntes_nnid=c63b8ed37551a0d21cdd8d09431f74f3,1735715018356; _ntes_nuid=c63b8ed37551a0d21cdd8d09431f74f3; WEVNSM=1.0.0; WNMCID=pczbkm.1735715018881.01.0; WM_TID=1nksXLORLLNERRUVVEPDcVgAnaczmxmt; __snaker__id=YKBJrgOdnmwSTYd5; sDeviceId=YD-LXGZGKBHf8FEQlFVEFaSdUgFmKdyvzed; ntes_utid=tid._.cOC3L0DE1OVFA1ARAAaWZR1Q2fNz%252BnbS._.0; P_INFO=18281597679|1735883543|1|music|00&99|null&null&null#AU&null#10#0|&0||18281597679; MUSIC_U=005F14D98085815617A46F437C40963858A89F21C6298AF32C5C2A19A880D6C6AF932D7E4D81158F2A9622830AE0EFAF0BB2C0D9265C0CD6EB6EA8474DC4C824C0E6EB5D338F4C5AB00478AA679972652185CAE8BEF0F75AB68A658854AEB8A1FAFCB1DDE95D9D19DC815524F401E3530B699E55538131CB4AEF07F5EA2F045BB0AA4DB7133558C97E5EE374FEDF8BBFCF1B84AE0A075C6CCB5D1BF3F89F713C14ED01CD2F95172AF95D40437B8DBB871B76C0A6973D307D503D16E7C8348D9A023F705599BD1817E766EE19E1F8B79085E3E1C82D4C8FE5FF8EA2E11497FCE57A79EBD058827A1118EB2A2F0F742070D6A69217CD3A4B7A9A56E9AF0CBEFA4E1E57DD45F5AA7D43E349FA333ACBC91B81FF224AC6D322F28BD1CDBAB65C3D17770E488BA70E970E35F82F066DFA79635490EA3F89AEC9502342644FD4AA317371E4F679270826D82F631CB71A25E1D57DA33EE897395C6F1724F13514D9928A3E; __remember_me=true; ntes_kaola_ad=1; gdxidpyhxdE=c8YfQw1J3MhDPeOcRjGbfY0v%5CiVt1pJ6ohPixq%5CWgEiYt7VnpNK13v2tCbSCfdpKj%2FL48VfV4jbavrBO65p%2Bf2qKVwLrDOuY%2BQNhstDW4yGApBC7TVJ3i6arhVVQk21WGil%2FBjHxNxO6prV1P%2FhWipYVR0bsc3qBGW6vD0skCbr0qPXb%3A1735899551287; __csrf=79a62388899b286e3d57511174527b9b; __csrf=79a62388899b286e3d57511174527b9b; JSESSIONID-WYYY=xdfpNij4Grl%2FOcxDPMFFfK7IHzrWnbUhiS83Wy8%2BZx1Cmn8bgJjNObysImKqP6f1BZrWEs%5C4Uex4mO%5Cw%2BbuUJ%5CrEWVm0S%2FJWYwCdAAd7ppGlJgins0OqwmOYmi2rRGSQ4h1rtPoROdhm4sOsOgpgWFTWn9TO7P2zsVPiBHYkhF%5CE4Ahi%3A1737591603064; WM_NI=xAiLjqq0rOd0vq%2FtiL%2BugSX2a67l0X4SQ3wISiI6l71hADhIBk1B%2Bud8qoISSE2uUWx56B8gWbGtM7BdRCCq6uqD6%2Bqjs8qbcmliounRXNuOnm84nW0IV1jjrWXoGz0ub08%3D; WM_NIKE=9ca17ae2e6ffcda170e2e6eed9bc3faa9c98b8ea3f97bc8fa7c55a878f8e83cb539a929bade84fb0b2b7baf02af0fea7c3b92abc9fa7ade97bb3f0beb0e73cb6afe195ec48e9aba9b4db3aa3eaf98db354f88d9fd4f64391b787d7ef3df3b88fa5eb4382b5ffa3aa7fa8e8bf90cc59919bfe96d85dbcebfaa3bb6d95be8995d03d82bc9ea4c27bf6abbfa5b521b3b6bdd9f46aa1b3a48aee7fae8e98aff845aeb3f8d5ed5df4979ad2e962b2899890c672f4abaed1bb37e2a3";
            await _next(context);
        }
    }
}
